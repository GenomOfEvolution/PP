# Конспект: `Task` и `Task.WhenAll` в C#

## 1. Объект `Task`

`Task` — основной класс для представления асинхронных операций в .NET. Предоставляет информацию о состоянии задачи и методы управления.

### Ключевые свойства (поля)
| Свойство          | Описание                                                                 |
|--------------------|--------------------------------------------------------------------------|
| `Status`           | Текущее состояние задачи (`TaskStatus`):<br>`Created`, `Running`, `RanToCompletion`, `Faulted`, `Canceled` и др. |
| `IsCompleted`      | `true`, если задача завершена (успешно, с ошибкой или отменена).       |
| `IsCanceled`       | `true`, если задача была отменена через `CancellationToken`.           |
| `IsFaulted`        | `true`, если в задаче возникло исключение.                              |
| `Exception`        | `AggregateException` с деталями ошибок (если `IsFaulted == true`).      |
| `Id`               | Уникальный идентификатор задачи.                                         |
| `Result`           | **Только для `Task<T>`**: результат выполнения задачи (блокирует поток при доступе). |

### Основные методы
| Метод                          | Описание                                                                 |
|--------------------------------|--------------------------------------------------------------------------|
| `Start()`                      | Запускает задачу (только если создана через конструктор, а не `Task.Run`). |
| `Wait()`                       | **Синхронное** ожидание завершения задачи (блокирует поток).            |
| `ContinueWith(...)`            | Регистрирует действие, выполняемое после завершения задачи.             |
| `ConfigureAwait(bool)`         | Настраивает поведение контекста после `await`:<br>`false` — избегать захвата контекста синхронизации (оптимизация для библиотек). |
| `Dispose()`                    | Освобождает ресурсы (редко используется, так как `Task` кэшируется CLR). |
| `RunSynchronously()`           | Выполняет задачу синхронно на текущем потоке (не рекомендуется).         |

---

## 2. `Task.WhenAll`

**Назначение**: Асинхронное ожидание завершения **всех** задач в коллекции.

### Сигнатуры
```csharp
// Для задач без результата
public static Task WhenAll(IEnumerable<Task> tasks);

// Для задач с результатом (возвращает массив результатов)
public static Task<TResult[]> WhenAll<TResult>(IEnumerable<Task<TResult>> tasks);
```